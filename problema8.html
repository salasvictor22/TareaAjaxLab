<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparación de Confirmados por Día (Excepto Lima y Callao)</title>
    <link rel="stylesheet" href="estilo8.css">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
    <h1>Comparación de Confirmados por Día (Excepto Lima y Callao)</h1>
    <select id="region1">
        <option value="Amazonas">Amazonas</option>
        <option value="Ancash">Ancash</option>
        <option value="Apurimac">Apurimac</option>
        <option value="Tumbes">Tumbes</option>
        <option value="Piura">Piura</option>
        <option value="Lambayeque">Lambayeque</option>
        <option value="La Libertad">La Libertad</option>
        <option value="Cajamarca">Cajamarca</option>
        <option value="Ica">Ica</option>
        <option value="Arequipa">Arequipa</option>
        <option value="Moquegua">Moquegua</option>
        <option value="Tacna">Tacna</option>
        <option value="Loreto">Loreto</option>
        <option value="San Martin">San Martin</option>
        <option value="Huanuco">Huanuco</option>
        <option value="Pasco">Pasco</option>
        <option value="Ucayali">Ucayali</option>
        <option value="Huancayo">Huancayo</option>
        <option value="Huancavelica">Huancavelica</option>
        <option value="Ayacucho">Ayacucho</option>
        <option value="Avancay">Avancay</option>
        <option value="Cusco">Cusco</option>
        <option value="Puno">Puno</option>
        <option value="Madre de Dios">Madre de Dios</option>
    </select>
    <select id="region2">
        <option value="Amazonas">Amazonas</option>
        <option value="Ancash">Ancash</option>
        <option value="Apurimac">Apurimac</option>
        <option value="Tumbes">Tumbes</option>
        <option value="Piura">Piura</option>
        <option value="Lambayeque">Lambayeque</option>
        <option value="La Libertad">La Libertad</option>
        <option value="Cajamarca">Cajamarca</option>
        <option value="Ica">Ica</option>
        <option value="Arequipa">Arequipa</option>
        <option value="Moquegua">Moquegua</option>
        <option value="Tacna">Tacna</option>
        <option value="Loreto">Loreto</option>
        <option value="San Martin">San Martin</option>
        <option value="Huanuco">Huanuco</option>
        <option value="Pasco">Pasco</option>
        <option value="Ucayali">Ucayali</option>
        <option value="Huancayo">Huancayo</option>
        <option value="Huancavelica">Huancavelica</option>
        <option value="Ayacucho">Ayacucho</option>
        <option value="Avancay">Avancay</option>
        <option value="Cusco">Cusco</option>
        <option value="Puno">Puno</option>
        <option value="Madre de Dios">Madre de Dios</option>
    </select>
    <button onclick="obtenerDatos()">Comparar</button>
    <button onclick="regresar()">Regresar</button>
    <div id="grafico">
        <div id="graficoComparativo" style="width: 900px; height: 500px;"></div>
    </div>
	
	<script type="text/javascript">
        google.charts.load('current', {packages: ['corechart', 'line']});
        google.charts.setOnLoadCallback(loadData);

        let globalData = [];

        function loadData() {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'data.json', true);
            xhr.onload = function() {
                if (this.status === 200) {
                    globalData = JSON.parse(this.responseText);
                    cargarRegiones();
                } else {
                    console.error('Error loading data');
                }
            };
            xhr.onerror = function() {
                console.error('Request error...');
            };
            xhr.send();
        }

        function cargarRegiones() {
            const select1 = document.getElementById('region1');
            const select2 = document.getElementById('region2');
            globalData.forEach(region => {
                if (region.region !== 'Lima' && region.region !== 'Callao') {
                    const option = document.createElement('option');
                    option.textContent = region.region;
                    select1.appendChild(option.cloneNode(true));
                    select2.appendChild(option);
                }
            });
        }

        function obtenerDatos() {
            const region1 = document.getElementById("region1").value;
            const region2 = document.getElementById("region2").value;
            mostrarGrafico(region1, region2);
        }

        function mostrarGrafico(region1, region2) {
            const data = new google.visualization.DataTable();
            data.addColumn('string', 'Fecha');
            data.addColumn('number', region1);
            data.addColumn('number', region2);

            globalData.forEach(region => {
                if (region.region !== 'Lima' && region.region !== 'Callao') {
                    region.confirmed.forEach(dato => {
                        const fecha = dato.date;
                        const confirmados = parseInt(dato.value);
                        if (region.region === region1) {
                            data.addRow([fecha, confirmados, 0]);
                        } else if (region.region === region2) {
                            data.addRow([fecha, 0, confirmados]);
                        }
                    });
                }
            });

            const options = {
                title: 'Comparación de Confirmados por Día (Excepto Lima y Callao)',
                width: 900,
                height: 500,
                hAxis: {
                    title: 'Fecha'
                },
                vAxis: {
                    title: 'Número de Confirmados'
                },
                series: {
                    0: { color: 'blue' },
                    1: { color: 'red' }
                }
            };

            const chart = new google.visualization.LineChart(document.getElementById('graficoComparativo'));
            chart.draw(data, options);
        }

        function limpiarGrafico() {
            document.getElementById('graficoComparativo').innerHTML = '';
        }
    </script>
</body>
</html>